* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: Arial, sans-serif;
    background: #222;
    color: white;
    overflow: hidden;
    height: 100vh;
    width: 100vw;
}

#gameArea {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: #000;
    font-family: 'Courier New', monospace;
    font-size: 24px;
    line-height: 24px;
    letter-spacing: 0;
    word-spacing: 0;
    white-space: pre;
    overflow: hidden;
    
    /* Pixel perfect rendering */
    image-rendering: pixelated;
    image-rendering: -moz-crisp-edges;
    image-rendering: crisp-edges;
    text-rendering: optimizeSpeed;
    
    border: none;
    outline: none;
    transform: translateZ(0);
    backface-visibility: hidden;
    font-variant-ligatures: none;
    text-decoration: none;
}

.symbol {
    display: inline;
    font-family: 'Courier New', monospace;
    font-size: 24px;
    line-height: 24px;
    font-weight: normal;
    margin: 0;
    padding: 0;
    border: 0;
    vertical-align: baseline;
    letter-spacing: 0;
    word-spacing: 0;
}

/* Player */
.player {
    color: #ff6b6b !important;
    text-shadow: 0 0 2px #ff6b6b;
    font-weight: bold;
}

/* REACTIVE: Enhanced deer entity styles with reaction states */
.deer-entity {
    color: #daa520 !important; /* Normal goldenrod */
    text-shadow: 0 0 1px #daa520;
    font-weight: bold;
}

/* Fleeing deer are bright gold with pulsing animation */
.deer-entity.deer-fleeing {
    color: #ffd700 !important;
    text-shadow: 0 0 2px #ffd700;
    animation: deer-panic 0.4s ease-in-out infinite alternate;
}

/* NEW: Reacting deer (have pending reactions) show subtle glow */
.deer-entity.deer-reacting {
    color: #ffaa00 !important;
    text-shadow: 0 0 3px #ffaa00;
    animation: deer-reacting 0.2s ease-in-out infinite alternate;
}

/* Panic animation for fleeing deer */
@keyframes deer-panic {
    from { 
        color: #ffd700;
        text-shadow: 0 0 2px #ffd700;
    }
    to { 
        color: #ffed4e;
        text-shadow: 0 0 4px #ffed4e;
    }
}

/* Fast pulse for reacting deer */
@keyframes deer-reacting {
    from { 
        color: #ffaa00;
        text-shadow: 0 0 2px #ffaa00;
    }
    to { 
        color: #ffcc33;
        text-shadow: 0 0 3px #ffcc33;
    }
}

/* Debug mode deer vision */
.deer-vision {
    background-color: rgba(218, 165, 32, 0.2) !important;
}

.deer-vision-player {
    background-color: rgba(255, 0, 0, 0.3) !important;
}

/* Terrain colors - with varied grass colors */
.terrain-grass { color: #00ff00; }
.terrain-grass-1 { color: #00e600; }
.terrain-grass-2 { color: #00ff00; }
.terrain-grass-3 { color: #1aff1a; }
.terrain-grass-4 { color: #00cc00; }
.terrain-grass-5 { color: #00b300; }
.terrain-grass-6 { color: #33ff33; }
.terrain-grass-7 { color: #00d900; }
.terrain-grass-8 { color: #26ff26; }

/* Tree feature colors */
.tree_trunk { color: #8b4513 !important; }
.tree_canopy { color: #008000 !important; }
.feature-tree-trunk { color: #8b4513 !important; }
.feature-tree-canopy { color: #008000 !important; }

/* Other terrain types */
.terrain-tree { color: #008000; }
.terrain-hills { color: #a0522d; }
.terrain-stone { color: #808080; }
.terrain-water { color: #0080ff; }
.terrain-path { color: #daa520; }
.terrain-road { color: #8b4513; }
.terrain-building { color: #654321; }
.terrain-village { color: #ffa500; }
.terrain-unknown { color: #404040; }

/* Fog of War colors */
.terrain-fog { color: #202020; }
.terrain-explored { opacity: 0.6; }

/* Fix for grass variations in fog of war */
.terrain-grass-1.terrain-explored,
.terrain-grass-2.terrain-explored,
.terrain-grass-3.terrain-explored,
.terrain-grass-4.terrain-explored,
.terrain-grass-5.terrain-explored,
.terrain-grass-6.terrain-explored,
.terrain-grass-7.terrain-explored,
.terrain-grass-8.terrain-explored {
    opacity: 0.6;
}


/* Base rocky terrain colors */
.terrain-rocks { color: #696969; }     /* Dim gray */
.terrain-boulders { color: #778899; }  /* Light slate gray */
.terrain-stone { color: #808080; }     /* Gray */

/* Rocky terrain variations for visual interest */
.terrain-rocks-1 { color: #696969; }   /* Dim gray */
.terrain-rocks-2 { color: #708090; }   /* Slate gray */
.terrain-rocks-3 { color: #778899; }   /* Light slate gray */
.terrain-rocks-4 { color: #2f4f4f; }   /* Dark slate gray */

.terrain-boulders-1 { color: #778899; } /* Light slate gray */
.terrain-boulders-2 { color: #696969; } /* Dim gray */
.terrain-boulders-3 { color: #708090; } /* Slate gray */
.terrain-boulders-4 { color: #556b2f; } /* Dark olive green (mossy boulders) */

.terrain-stone-1 { color: #808080; }    /* Gray */
.terrain-stone-2 { color: #a9a9a9; }    /* Dark gray */
.terrain-stone-3 { color: #696969; }    /* Dim gray */
.terrain-stone-4 { color: #dcdcdc; }    /* Gainsboro (lighter stone) */

/* Fog of war support for rocky terrain variations */
.symbol.terrain-rocks-1.terrain-explored,
.symbol.terrain-rocks-2.terrain-explored,
.symbol.terrain-rocks-3.terrain-explored,
.symbol.terrain-rocks-4.terrain-explored,
.symbol.terrain-boulders-1.terrain-explored,
.symbol.terrain-boulders-2.terrain-explored,
.symbol.terrain-boulders-3.terrain-explored,
.symbol.terrain-boulders-4.terrain-explored,
.symbol.terrain-stone-1.terrain-explored,
.symbol.terrain-stone-2.terrain-explored,
.symbol.terrain-stone-3.terrain-explored,
.symbol.terrain-stone-4.terrain-explored {
    opacity: 0.6 !important;
}

/* Base terrain classes for fog of war */
.symbol.terrain-rocks.terrain-explored,
.symbol.terrain-boulders.terrain-explored,
.symbol.terrain-stone.terrain-explored {
    opacity: 0.6 !important;
}


/* Basic water terrain - keep existing */
.terrain-water { 
    color: #0080ff; 
}

/* === FLOWING RIVER STYLES === */

/* Basic flowing river sections */
.terrain-water.river-horizontal,
.terrain-water.river-vertical {
    color: #4da6ff !important;  /* Bright flowing blue */
    text-shadow: 0 0 2px #0080ff;
    animation: river-flow 3s ease-in-out infinite;
}

/* River bends and curves */
.terrain-water.river-northeast,
.terrain-water.river-northwest,
.terrain-water.river-southeast,
.terrain-water.river-southwest {
    color: #66b3ff !important;  /* Slightly lighter for curves */
    text-shadow: 0 0 2px #1a8cff;
    animation: river-bend 4s ease-in-out infinite;
}

/* River junctions and confluences */
.terrain-water.river-junction,
.terrain-water.river-confluence {
    color: #3399ff !important;  /* Vibrant blue for confluences */
    text-shadow: 0 0 3px #0066cc;
    animation: river-confluence 2.5s ease-in-out infinite;
}

/* Special river features */
.terrain-water.river-source {
    color: #00ccff !important;  /* Bright cyan for spring sources */
    text-shadow: 0 0 4px #00aadd;
    animation: spring-bubble 1.5s ease-in-out infinite;
}

.terrain-water.river-mouth {
    color: #0099dd !important;  /* Deep blue for river mouths */
    text-shadow: 0 0 2px #006699;
    animation: river-mouth 3.5s ease-in-out infinite;
}

.terrain-water.river-rapids {
    color: #ffffff !important;  /* White for rapids/fast flow */
    text-shadow: 0 0 3px #4da6ff;
    animation: rapids 0.8s ease-in-out infinite;
}

/* === RIVER ANIMATIONS === */

/* Basic flowing animation - gentle pulse */
@keyframes river-flow {
    0% { 
        color: #4da6ff;
        text-shadow: 0 0 2px #0080ff;
    }
    50% { 
        color: #66b3ff;
        text-shadow: 0 0 3px #1a8cff;
    }
    100% { 
        color: #4da6ff;
        text-shadow: 0 0 2px #0080ff;
    }
}

/* River bend animation - slightly different timing */
@keyframes river-bend {
    0% { 
        color: #66b3ff;
        text-shadow: 0 0 2px #1a8cff;
    }
    33% { 
        color: #4da6ff;
        text-shadow: 0 0 3px #0080ff;
    }
    66% { 
        color: #80ccff;
        text-shadow: 0 0 2px #3399ff;
    }
    100% { 
        color: #66b3ff;
        text-shadow: 0 0 2px #1a8cff;
    }
}

/* Confluence animation - more dramatic pulsing */
@keyframes river-confluence {
    0% { 
        color: #3399ff;
        text-shadow: 0 0 3px #0066cc;
        transform: scale(1);
    }
    50% { 
        color: #66b3ff;
        text-shadow: 0 0 5px #1a8cff;
        transform: scale(1.05);
    }
    100% { 
        color: #3399ff;
        text-shadow: 0 0 3px #0066cc;
        transform: scale(1);
    }
}

/* Spring source animation - bubbling effect */
@keyframes spring-bubble {
    0% { 
        color: #00ccff;
        text-shadow: 0 0 4px #00aadd;
        transform: scale(1);
    }
    25% { 
        color: #33ddff;
        text-shadow: 0 0 6px #00ccee;
        transform: scale(1.1);
    }
    50% { 
        color: #66eeff;
        text-shadow: 0 0 8px #33ddff;
        transform: scale(1.15);
    }
    75% { 
        color: #33ddff;
        text-shadow: 0 0 6px #00ccee;
        transform: scale(1.1);
    }
    100% { 
        color: #00ccff;
        text-shadow: 0 0 4px #00aadd;
        transform: scale(1);
    }
}

/* River mouth animation - gentle flowing into larger body */
@keyframes river-mouth {
    0% { 
        color: #0099dd;
        text-shadow: 0 0 2px #006699;
    }
    50% { 
        color: #1aa3e6;
        text-shadow: 0 0 4px #0077bb;
    }
    100% { 
        color: #0099dd;
        text-shadow: 0 0 2px #006699;
    }
}

/* Rapids animation - fast, chaotic movement */
@keyframes rapids {
    0% { 
        color: #ffffff;
        text-shadow: 0 0 3px #4da6ff;
        transform: translateY(0);
    }
    25% { 
        color: #e6f7ff;
        text-shadow: 0 0 5px #66b3ff;
        transform: translateY(-1px);
    }
    50% { 
        color: #ccf2ff;
        text-shadow: 0 0 4px #80ccff;
        transform: translateY(0);
    }
    75% { 
        color: #e6f7ff;
        text-shadow: 0 0 5px #66b3ff;
        transform: translateY(1px);
    }
    100% { 
        color: #ffffff;
        text-shadow: 0 0 3px #4da6ff;
        transform: translateY(0);
    }
}

/* === FOG OF WAR SUPPORT FOR RIVERS === */

/* Dimmed flowing rivers when explored but not visible */
.terrain-water.terrain-explored {
    opacity: 0.6 !important;
    animation-duration: 6s !important; /* Slower animation when dimmed */
}

/* Preserve river animations even when explored */
.terrain-water.river-horizontal.terrain-explored,
.terrain-water.river-vertical.terrain-explored {
    animation: river-flow 6s ease-in-out infinite;
}

.terrain-water.river-confluence.terrain-explored {
    animation: river-confluence 5s ease-in-out infinite;
}

.terrain-water.river-source.terrain-explored {
    animation: spring-bubble 3s ease-in-out infinite;
}

/* === LAKE STYLES === */

/* Enhanced lake appearance */
.terrain-water.lake {
    color: #0066cc !important;
    text-shadow: 0 0 2px #004499;
    animation: lake-ripple 8s ease-in-out infinite;
}

/* Lake ripple animation - very subtle */
@keyframes lake-ripple {
    0% { 
        color: #0066cc;
        text-shadow: 0 0 2px #004499;
    }
    50% { 
        color: #1a77dd;
        text-shadow: 0 0 3px #0055aa;
    }
    100% { 
        color: #0066cc;
        text-shadow: 0 0 2px #004499;
    }
}

/* === RESPONSIVE RIVER RENDERING === */

/* Ensure rivers look good at different screen sizes */
@media (max-width: 768px) {
    .terrain-water {
        text-shadow: 0 0 1px #0080ff; /* Smaller glow on mobile */
    }
    
    .terrain-water.river-source {
        animation-duration: 2s; /* Faster on mobile for better visibility */
    }
    
    .terrain-water.rapids {
        animation-duration: 1s;
    }
}

/* High contrast mode support */
@media (prefers-contrast: high) {
    .terrain-water {
        color: #00ffff !important;
        text-shadow: none !important;
        animation: none !important;
    }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
    .terrain-water {
        animation: none !important;
    }
}

/* Status bar */
.status {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: rgba(34, 34, 34, 0.9);
    display: flex;
    gap: 20px;
    padding: 10px 20px;
    border-top: 1px solid #444;
    z-index: 1000;
    font-size: 14px;
}

.status span {
    padding: 5px 10px;
    border-radius: 3px;
    font-weight: bold;
}

.status .available {
    background: #1a4d1a;
    color: #4f4;
}

.status .unavailable {
    background: #4d1a1a;
    color: #f44;
}

.facing-info {
    background: rgba(64, 64, 64, 0.8);
    color: #ccc;
}

.instructions {
    position: fixed;
    top: 10px;
    left: 10px;
    color: rgba(170, 170, 170, 0.8);
    font-style: italic;
    font-size: 12px;
    z-index: 1000;
    background: rgba(0, 0, 0, 0.5);
    padding: 5px 10px;
    border-radius: 3px;
    max-width: 600px;
}

.instructions.fade-out {
    animation: fadeOut 2s ease-in-out 5s forwards; /* Increased delay for more complex instructions */
}

@keyframes fadeOut {
    to {
        opacity: 0;
        pointer-events: none;
    }
}

/* NEW: Additional visual feedback for reactive system */
.reactive-indicator {
    position: fixed;
    top: 50px;
    right: 10px;
    background: rgba(255, 170, 0, 0.8);
    color: black;
    padding: 5px 10px;
    border-radius: 3px;
    font-size: 12px;
    font-weight: bold;
    z-index: 1001;
    animation: fade-in-out 2s ease-in-out;
}

@keyframes fade-in-out {
    0% { opacity: 0; transform: translateX(20px); }
    50% { opacity: 1; transform: translateX(0); }
    100% { opacity: 0; transform: translateX(-20px); }
}